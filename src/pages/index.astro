---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const oracoes = await getCollection('oracoes');

// Ordena pelas mais recentes usando pubDate
const oracoesRecentes = oracoes
  .filter((oracao) => oracao.data.pubDate)
  .sort((a, b) => new Date(b.data.pubDate) - new Date(a.data.pubDate))
  .slice(0, 3); // mostra sÃ³ as 6 mais recentes
---

<Layout 
  title="InÃ­cio"
  description="Bem-vinde ao Jurema, Estrada e Mar â€“ um espaÃ§o espiritual com oraÃ§Ãµes, pontos cantados e ensinamentos guiados por luz e axÃ©."
>
  <main class="inicio">
    <!-- ğŸŒ¼ SaudaÃ§Ã£o espiritual -->
    <section class="saudacao">
      <h1>Jurema, Estrada e Mar</h1>
      <p>
        Aqui a palavra Ã© cura. O canto Ã© oraÃ§Ã£o.<br/>
        O axÃ© Ã© luz. Seja bem-vinde ao nosso espaÃ§o de fÃ©, sabedoria ancestral e acolhimento espiritual.
      </p>
    </section>

    <!-- ğŸŒ¿ Ãšltimas OraÃ§Ãµes (automÃ¡ticas) -->
    <section class="secao-home ultimas-oracoes">
      <h2>ğŸ•Šï¸ Ãšltimas OraÃ§Ãµes</h2>
      <div class="grade-oracoes">
        {oracoesRecentes.map(({ data }) => (
          <a href={data.slug ? `/oracoes/${data.slug}` : '#'} class="card-oracao">
            <img src={data.image} alt={data.title} />
            <h3>{data.title}</h3>
          </a>
        ))}
      </div>
    </section>

    <!-- ğŸ¶ Pontos Cantados -->
    <section class="secao-home">
      <h2>ğŸ¶ Pontos Cantados</h2>
      <p>Em breve vocÃª encontrarÃ¡ aqui cantos de fÃ© que vibram com a forÃ§a dos guias da Umbanda.</p>
      <a class="ver-todas" href="/pontos">Ir para os pontos</a>
    </section>

    <!-- ğŸ“˜ Ensinamentos -->
    <section class="secao-home">
      <h2>ğŸ“˜ Ensinamentos Espirituais</h2>
      <p>ReflexÃµes e fundamentos recebidos da espiritualidade. Em breve!</p>
      <a class="ver-todas" href="/ensinamentos">Ver ensinamentos</a>
    </section>
  </main>
</Layout>
