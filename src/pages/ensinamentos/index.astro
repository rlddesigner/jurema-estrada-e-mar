---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// Puxa todos os ensinamentos
const ensinamentos = await getCollection('ensinamentos');

// Organiza do mais recente para o mais antigo
const ensinamentosRecentes = ensinamentos
  .filter((e) => e.data.pubDate)
  .sort((a, b) => new Date(b.data.pubDate) - new Date(a.data.pubDate));

// Lista manual das categorias
const categorias = [
  { nome: "Guias e Falanges", slug: "ensinamento-guias" },
  { nome: "PrÃ¡ticas Espirituais", slug: "ensinamento-praticas" },
  { nome: "Desenvolvimento MediÃºnico", slug: "ensinamento-mediunidade" },
  { nome: "Saberes e Mensagens", slug: "ensinamento-saberes" },
];
---
<Layout 
  title="Ensinamentos Espirituais"
  description="ReflexÃµes, fundamentos e sabedorias da Umbanda, compartilhados com amor e axÃ©."
>
  <main class="pagina-lista">

    <!-- ğŸ§­ Menu de Categorias -->
    <section class="menu-categorias">
      <h2>ğŸŒ¿ Escolha uma Categoria</h2>
      <ul>
        {categorias.map((cat) => (
          <li>
            <a href={`/ensinamentos/${cat.slug}`}>
              {cat.nome}
            </a>
          </li>
        ))}
      </ul>
    </section>

    <!-- ğŸ“š Lista de Ensinamentos Recentes -->
    <section class="secao-home">
      <h2>ğŸ“˜ Todos os Ensinamentos</h2>
      <div class="grade-ensinamentos">
        {ensinamentosRecentes.map(({ data }) => (
          <a href={`/ensinamentos/${data.slug}`} class="card-oracao">
            {data.image && <img src={data.image} alt={data.title} />}
            <h3>{data.title}</h3>
            <p>{data.description}</p>
          </a>
        ))}
      </div>
    </section>

  </main>
</Layout>
